library(ape)
tree_417 = read.tree("E:/re-do_V2/00_dataset_production/output/tree_417_norm_validNames.tre")
subtree = extract.clade(phy = tree_417, node = 421)
length(subtree$tip.label)
length(subtree$tip.label)
write.tree(subtree, "E:/re-do_V2/07_subtree/input/subtree_326.tre")
files <- list.files("E:/re-do_V2/04_Dtest_417sp_all_traits/input", pattern="*.txt", full.names=TRUE)
for ( i in 1:length(files)){
temp = read.csv(files[1], sep = "\t")
temp = temp[temp$X417 %in% subtree$tip.label,]
colnames(temp) = c("326", "1")
#write.table(temp, paste0("E:/re-do_V2/07_subtree/input/", strsplit(files[i], split = "/")[[1]][5]), quote = F, row.names = F)
}
View(temp)
paste0("E:/re-do_V2/07_subtree/input/", strsplit(files[i], split = "/")[[1]][5])
strsplit(strsplit(files[i], split = "/")[[1]][5], split = "_")[[1]][1])
strsplit(strsplit(files[i], split = "/")[[1]][5], split = "_")[[1]][1]
subtree = extract.clade(phy = tree_417, node = 421)
length(subtree$tip.label)
write.tree(subtree, "E:/re-do_V2/07_subtree/input/subtree_326.tre")
files <- list.files("E:/re-do_V2/04_Dtest_417sp_all_traits/input", pattern="*.txt", full.names=TRUE)
for ( i in 1:length(files)){
temp = read.csv(files[1], sep = "\t")
temp = temp[temp$X417 %in% subtree$tip.label,]
colnames(temp) = c("326", "1")
write.table(temp, paste0("E:/re-do_V2/07_subtree/input/", strsplit(strsplit(files[i], split = "/")[[1]][5], split = "_")[[1]][1], "_326"), quote = F, row.names = F)
}
subtree = extract.clade(phy = tree_417, node = 421)
length(subtree$tip.label)
write.tree(subtree, "E:/re-do_V2/07_subtree/input/subtree_326.tre")
files <- list.files("E:/re-do_V2/04_Dtest_417sp_all_traits/input", pattern="*.txt", full.names=TRUE)
for ( i in 1:length(files)){
temp = read.csv(files[1], sep = "\t")
temp = temp[temp$X417 %in% subtree$tip.label,]
colnames(temp) = c("326", "1")
write.table(temp, paste0("E:/re-do_V2/07_subtree/input/", strsplit(strsplit(files[i], split = "/")[[1]][5], split = "_")[[1]][1], "_326.txt"), quote = F, row.names = F)
}
files
files <- list.files("E:/re-do_V2/04_Dtest_417sp_all_traits/input", pattern="troph", full.names=TRUE)
files <- list.files("E:/re-do_V2/04_Dtest_417sp_all_traits/input", pattern="troph", full.names=TRUE)
files
for ( i in 1:length(files)){
temp = read.csv(files[1], sep = "\t")
temp = temp[temp$X417 %in% subtree$tip.label,]
colnames(temp) = c("326", "1")
write.table(temp, paste0("E:/re-do_V2/07_subtree/input/", strsplit(strsplit(files[i], split = "/")[[1]][5], split = "_")[[1]][1], "_326.txt"), quote = F, row.names = F)
}
marg_r1_ARD = -79.4151367889462
marg_r1_ER = -79.05961379188611
marg_r0_ARD = -83.65635049510196
marg_r0_ER = -84.3443167018145
BF1ARD = 2(marg_r1_ER - marg_r1_ARD)
### Bayes Factor calculation
marg_r1_ARD = -79.4151367889462
marg_r1_ER = -79.05961379188611
marg_r0_ARD = -83.65635049510196
marg_r0_ER = -84.3443167018145
BF1ARD = 2*(marg_r1_ER - marg_r1_ARD)
BF0ARD = 2*(marg_r1_ER - marg_r0_ARD)
BF0ER = 2*(marg_r1_ER - marg_r0_ER)
# Probabilities
exp(marg_r1_ER) /(exp(marg_r1_ARD) +
exp(marg_r1_ER) +
exp(marg_r0_ARD) +
exp(marg_r0_ER))
p2 = exp(marg_r1_ARD) /(exp(marg_r1_ARD) +
exp(marg_r1_ER) +
exp(marg_r0_ARD) +
exp(marg_r0_ER))
p1 = exp(marg_r1_ER) /(exp(marg_r1_ARD) +
exp(marg_r1_ER) +
exp(marg_r0_ARD) +
exp(marg_r0_ER))
p2 = exp(marg_r1_ARD) /(exp(marg_r1_ARD) +
exp(marg_r1_ER) +
exp(marg_r0_ARD) +
exp(marg_r0_ER))
p3 = exp(marg_r0_ER) /(exp(marg_r1_ARD) +
exp(marg_r1_ER) +
exp(marg_r0_ARD) +
exp(marg_r0_ER))
p4 = exp(marg_r0_ARD) /(exp(marg_r1_ARD) +
exp(marg_r1_ER) +
exp(marg_r0_ARD) +
exp(marg_r0_ER))
p1 + p2
### Gamergates subtree
marg_r1_ARD = -127.4557175
marg_r1_ER = -133.789655
marg_r0_ARD = -127.4292635
marg_r0_ER = -126.8114302
### Gamergates subtree
marg_r1_ARD = -127.4557175
marg_r1_ER = -133.789655
marg_r0_ARD = -127.4292635
marg_r0_ER = -126.8114302
BF1ARD = 2*(marg_r0_ARD - marg_r1_ARD)
BF1ER = 2*(marg_r0_ARD - marg_r1_ER)
BF0ER = 2*(marg_r0_ARD - marg_r0_ER)
# Probabilities
p1 = exp(marg_r1_ER) /(exp(marg_r1_ARD) +
exp(marg_r1_ER) +
exp(marg_r0_ARD) +
exp(marg_r0_ER))
p2 = exp(marg_r1_ARD) /(exp(marg_r1_ARD) +
exp(marg_r1_ER) +
exp(marg_r0_ARD) +
exp(marg_r0_ER))
p3 = exp(marg_r0_ER) /(exp(marg_r1_ARD) +
exp(marg_r1_ER) +
exp(marg_r0_ARD) +
exp(marg_r0_ER))
p4 = exp(marg_r0_ARD) /(exp(marg_r1_ARD) +
exp(marg_r1_ER) +
exp(marg_r0_ARD) +
exp(marg_r0_ER))
p3 + p4
marg_r0_ARD_st =
marg_r0_ER_st = -133.86754435085822
BF0ERST = 2*(marg_r0_ARD - marg_r0_ER_st)
### Gamergates subtree
marg_r1_ARD = -127.4557175
marg_r1_ER = -133.789655
marg_r0_ARD = -127.4292635
marg_r0_ER = -126.8114302
marg_r0_ARD_st = -132.04242092056654
marg_r0_ER_st = -133.86754435085822
BF1ARD = 2*(marg_r0_ARD - marg_r1_ARD)
BF1ER = 2*(marg_r0_ARD - marg_r1_ER)
BF0ER = 2*(marg_r0_ARD - marg_r0_ER)
BF1ERST = 2*(marg_r0_ARD - marg_r0_ARD_st)
BF0ERST = 2*(marg_r0_ARD - marg_r0_ER_st)
# Probabilities
p1 = exp(marg_r1_ER) /(exp(marg_r1_ARD) +
exp(marg_r1_ER) +
exp(marg_r0_ARD) +
exp(marg_r0_ER_st) +
exp(marg_r0_ARD_st) +
exp(marg_r0_ER))
p2 = exp(marg_r1_ARD) /(exp(marg_r1_ARD) +
exp(marg_r1_ER) +
exp(marg_r0_ARD) +
exp(marg_r0_ER_st) +
exp(marg_r0_ARD_st) +
exp(marg_r0_ER))
p3 = exp(marg_r0_ER) /(exp(marg_r1_ARD) +
exp(marg_r1_ER) +
exp(marg_r0_ARD) +
exp(marg_r0_ER_st) +
exp(marg_r0_ARD_st) +
exp(marg_r0_ER))
p4 = exp(marg_r0_ARD) /(exp(marg_r1_ARD) +
exp(marg_r1_ER) +
exp(marg_r0_ARD) +
exp(marg_r0_ER_st) +
exp(marg_r0_ARD_st) +
exp(marg_r0_ER))
### Gamergates subtree
marg_r1_ARD = -127.4557175
marg_r1_ER = -133.789655
marg_r0_ARD = -127.4292635
marg_r0_ER = -126.8114302
marg_r0_ARD_st = -132.04242092056654
marg_r0_ER_st = -133.86754435085822
BF1ARD = 2*(marg_r0_ARD - marg_r1_ARD)
BF1ER = 2*(marg_r0_ARD - marg_r1_ER)
BF0ER = 2*(marg_r0_ARD - marg_r0_ER)
BF1ERST = 2*(marg_r0_ARD - marg_r0_ARD_st)
BF0ERST = 2*(marg_r0_ARD - marg_r0_ER_st)
# Probabilities
p1 = exp(marg_r1_ER) /(exp(marg_r1_ARD) +
exp(marg_r1_ER) +
exp(marg_r0_ARD) +
exp(marg_r0_ER_st) +
exp(marg_r0_ARD_st) +
exp(marg_r0_ER))
p2 = exp(marg_r1_ARD) /(exp(marg_r1_ARD) +
exp(marg_r1_ER) +
exp(marg_r0_ARD) +
exp(marg_r0_ER_st) +
exp(marg_r0_ARD_st) +
exp(marg_r0_ER))
p3 = exp(marg_r0_ER) /(exp(marg_r1_ARD) +
exp(marg_r1_ER) +
exp(marg_r0_ARD) +
exp(marg_r0_ER_st) +
exp(marg_r0_ARD_st) +
exp(marg_r0_ER))
p4 = exp(marg_r0_ARD) /(exp(marg_r1_ARD) +
exp(marg_r1_ER) +
exp(marg_r0_ARD) +
exp(marg_r0_ER_st) +
exp(marg_r0_ARD_st) +
exp(marg_r0_ER))
p5 = exp(marg_r0_ARD_st) /(exp(marg_r1_ARD) +
exp(marg_r1_ER) +
exp(marg_r0_ARD) +
exp(marg_r0_ER_st) +
exp(marg_r0_ARD_st) +
exp(marg_r0_ER))
p6 = exp(marg_r0_ER_st) /(exp(marg_r1_ARD) +
exp(marg_r1_ER) +
exp(marg_r0_ARD) +
exp(marg_r0_ER_st) +
exp(marg_r0_ARD_st) +
exp(marg_r0_ER))
p3 + p4 + p5 + p6
marg_r1_ARD = -127.4557175
marg_r1_ER = -133.789655
marg_r0_ARD = -127.4292635
marg_r0_ER = -126.8114302
marg_r0_ARD_st = -132.04242092056654
marg_r0_ER_st = -133.86754435085822
BF1ARD = 2*(marg_r0_ARD - marg_r1_ARD)
BF1ARD
BF1ER = 2*(marg_r0_ARD - marg_r1_ER)
BF1ER
BF0ER = 2*(marg_r0_ARD - marg_r0_ER)
BF0ER
BF1ERST = 2*(marg_r0_ARD - marg_r0_ARD_st)
BF1ERST
BF0ERST = 2*(marg_r0_ARD - marg_r0_ER_st)
BF0ERST
BF1ARD = 2*(marg_r0_ER - marg_r1_ARD)
BF1ARD
BF1ER = 2*(marg_r0_ER - marg_r1_ER)
BF1ER
BF0ER = 2*(marg_r0_ER - marg_r0_ARD)
BF0ER
BF1ERST = 2*(marg_r0_ER - marg_r0_ARD_st)
BF1ERST
BF0ERST = 2*(marg_r0_ER - marg_r0_ER_st)
BF0ERST
BF1ARD = 2*(marg_r0_ER - marg_r1_ARD)
BF1ARD
BF1ER = 2*(marg_r0_ER - marg_r1_ER)
BF1ER
BF0ER = 2*(marg_r0_ER - marg_r0_ARD)
BF0ER
BF1ERST = 2*(marg_r0_ER - marg_r0_ARD_st)
BF1ERST
BF0ERST = 2*(marg_r0_ER - marg_r0_ER_st)
BF0ERST
BF0ARD = 2*(marg_r0_ER - marg_r0_ARD)
BF0ARD
BF0ARDST = 2*(marg_r0_ER - marg_r0_ARD_st)
BF0ARDST
BF0ARDST
BF0ERST = 2*(marg_r0_ER - marg_r0_ER_st)
BF0ERST
p3 + p4 + p5 + p6
p3
p4
p5
p6
p3 + p4 + p5 + p6
p3 = exp(marg_r0_ER) /(exp(marg_r1_ARD) +
exp(marg_r1_ER) +
exp(marg_r0_ARD) +
# exp(marg_r0_ER_st) +
# exp(marg_r0_ARD_st) +
exp(marg_r0_ER))
p4 = exp(marg_r0_ARD) /(exp(marg_r1_ARD) +
exp(marg_r1_ER) +
exp(marg_r0_ARD) +
# exp(marg_r0_ER_st) +
# exp(marg_r0_ARD_st) +
exp(marg_r0_ER))
### Troph subtree
marg_r1_ARD = -79.4151367889462
marg_r1_ER = -79.05961379188611
marg_r0_ARD = -83.65635049510196
marg_r0_ER = -84.3443167018145
BF1ARD = 2*(marg_r1_ER - marg_r1_ARD)
BF0ARD = 2*(marg_r1_ER - marg_r0_ARD)
BF0ER = 2*(marg_r1_ER - marg_r0_ER)
# Probabilities
p1 = exp(marg_r1_ER) /(exp(marg_r1_ARD) +
exp(marg_r1_ER) +
exp(marg_r0_ARD) +
exp(marg_r0_ER))
p2 = exp(marg_r1_ARD) /(exp(marg_r1_ARD) +
exp(marg_r1_ER) +
exp(marg_r0_ARD) +
exp(marg_r0_ER))
p3 = exp(marg_r0_ER) /(exp(marg_r1_ARD) +
exp(marg_r1_ER) +
exp(marg_r0_ARD) +
exp(marg_r0_ER))
p4 = exp(marg_r0_ARD) /(exp(marg_r1_ARD) +
exp(marg_r1_ER) +
exp(marg_r0_ARD) +
exp(marg_r0_ER))
p1 + p2
# Proba root 1 = p1 + p2 = 99 %
### Troph subtree : Lowest Marg likelihood = best model
marg_r1_ARD = -79.4151367889462
marg_r1_ER = -79.05961379188611
marg_r0_ARD = -83.65635049510196
marg_r0_ER = -84.3443167018145
BF1ARD = 2*(marg_r1_ER - marg_r1_ARD)
BF0ARD = 2*(marg_r1_ER - marg_r0_ARD)
BF0ER = 2*(marg_r1_ER - marg_r0_ER)
BF0ARD
BF0ER
p1 = exp(marg_r1_ER) /(exp(marg_r1_ARD) +
exp(marg_r1_ER) +
exp(marg_r0_ARD) +
exp(marg_r0_ER))
p2 = exp(marg_r1_ARD) /(exp(marg_r1_ARD) +
exp(marg_r1_ER) +
exp(marg_r0_ARD) +
exp(marg_r0_ER))
p3 = exp(marg_r0_ER) /(exp(marg_r1_ARD) +
exp(marg_r1_ER) +
exp(marg_r0_ARD) +
exp(marg_r0_ER))
p4 = exp(marg_r0_ARD) /(exp(marg_r1_ARD) +
exp(marg_r1_ER) +
exp(marg_r0_ARD) +
exp(marg_r0_ER))
p1 + p2
marg_r1_ARD = -127.4557175
marg_r1_ER = -133.789655
marg_r0_ARD = -127.4292635
marg_r0_ER = -126.8114302
marg_r0_ARD_st = -132.04242092056654
marg_r0_ER_st = -133.86754435085822
BF1ARD = 2*(marg_r0_ER - marg_r1_ARD)
BF1ARD
BF1ER = 2*(marg_r0_ER - marg_r1_ER)
BF1ER
BF0ARD = 2*(marg_r0_ER - marg_r0_ARD)
BF0ARD
BF0ARDST = 2*(marg_r0_ER - marg_r0_ARD_st)
BF0ARDST
BF0ERST = 2*(marg_r0_ER - marg_r0_ER_st)
BF0ERST
p1 = exp(marg_r1_ER) /(exp(marg_r1_ARD) +
exp(marg_r1_ER) +
exp(marg_r0_ARD) +
exp(marg_r0_ER_st) +
exp(marg_r0_ARD_st) +
exp(marg_r0_ER))
p2 = exp(marg_r1_ARD) /(exp(marg_r1_ARD) +
exp(marg_r1_ER) +
exp(marg_r0_ARD) +
exp(marg_r0_ER_st) +
exp(marg_r0_ARD_st) +
exp(marg_r0_ER))
p3 = exp(marg_r0_ER) /(exp(marg_r1_ARD) +
exp(marg_r1_ER) +
exp(marg_r0_ARD) +
exp(marg_r0_ER_st) +
exp(marg_r0_ARD_st) +
exp(marg_r0_ER))
p4 = exp(marg_r0_ARD) /(exp(marg_r1_ARD) +
exp(marg_r1_ER) +
exp(marg_r0_ARD) +
exp(marg_r0_ER_st) +
exp(marg_r0_ARD_st) +
exp(marg_r0_ER))
p5 = exp(marg_r0_ARD_st) /(exp(marg_r1_ARD) +
exp(marg_r1_ER) +
exp(marg_r0_ARD) +
exp(marg_r0_ER_st) +
exp(marg_r0_ARD_st) +
exp(marg_r0_ER))
p6 = exp(marg_r0_ER_st) /(exp(marg_r1_ARD) +
exp(marg_r1_ER) +
exp(marg_r0_ARD) +
exp(marg_r0_ER_st) +
exp(marg_r0_ARD_st) +
exp(marg_r0_ER))
p3 + p4 + p5 + p6
BF1ARD = 2*(marg_r1_ER - marg_r1_ARD)
BF1ARD
BF0ARD
BF0ER
marg_r1_ARD = -79.4151367889462
marg_r1_ER = -79.05961379188611
marg_r0_ARD = -83.65635049510196
marg_r0_ER = -84.3443167018145
BF1ARD = 2*(marg_r1_ER - marg_r1_ARD)
BF0ARD = 2*(marg_r1_ER - marg_r0_ARD)
BF0ER = 2*(marg_r1_ER - marg_r0_ER)
# Probabilities
p1 = exp(marg_r1_ER) /(exp(marg_r1_ARD) +
exp(marg_r1_ER) +
exp(marg_r0_ARD) +
exp(marg_r0_ER))
p2 = exp(marg_r1_ARD) /(exp(marg_r1_ARD) +
exp(marg_r1_ER) +
exp(marg_r0_ARD) +
exp(marg_r0_ER))
p3 = exp(marg_r0_ER) /(exp(marg_r1_ARD) +
exp(marg_r1_ER) +
exp(marg_r0_ARD) +
exp(marg_r0_ER))
p4 = exp(marg_r0_ARD) /(exp(marg_r1_ARD) +
exp(marg_r1_ER) +
exp(marg_r0_ARD) +
exp(marg_r0_ER))
p1 + p2
# Proba root 1 = p1 + p2 = 99 %
BF1ARD
### Troph subtree : Lowest Marg likelihood = best model
marg_r1_ARD = -79.4151367889462
marg_r1_ER = -79.05961379188611
marg_r0_ARD = -83.65635049510196
marg_r0_ER = -84.3443167018145
BF1ARD = 2*(marg_r1_ER - marg_r1_ARD)
BF0ARD = 2*(marg_r1_ER - marg_r0_ARD)
BF0ER = 2*(marg_r1_ER - marg_r0_ER)
# Probabilities
p1 = exp(marg_r1_ER) /(exp(marg_r1_ARD) +
exp(marg_r1_ER) +
exp(marg_r0_ARD) +
exp(marg_r0_ER))
p2 = exp(marg_r1_ARD) /(exp(marg_r1_ARD) +
exp(marg_r1_ER) +
exp(marg_r0_ARD) +
exp(marg_r0_ER))
p3 = exp(marg_r0_ER) /(exp(marg_r1_ARD) +
exp(marg_r1_ER) +
exp(marg_r0_ARD) +
exp(marg_r0_ER))
p4 = exp(marg_r0_ARD) /(exp(marg_r1_ARD) +
exp(marg_r1_ER) +
exp(marg_r0_ARD) +
exp(marg_r0_ER))
p1 + p2
BF1ARD
BF0ARD
BF0ER
marg_r1_ARD = -127.4557175
marg_r1_ER = -133.789655
marg_r0_ARD = -127.4292635
marg_r0_ER = -126.8114302
marg_r0_ARD_st = -132.04242092056654
marg_r0_ER_st = -133.86754435085822
BF1ARD = 2*(marg_r0_ER - marg_r1_ARD)
BF1ARD
BF1ER = 2*(marg_r0_ER - marg_r1_ER)
BF1ER
BF0ARD = 2*(marg_r0_ER - marg_r0_ARD)
BF0ARD
BF0ARDST = 2*(marg_r0_ER - marg_r0_ARD_st)
BF0ARDST
BF0ERST = 2*(marg_r0_ER - marg_r0_ER_st)
BF0ERST
